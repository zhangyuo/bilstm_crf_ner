# lstm_crf

基于tensorflow version 0.13，使用lstm神经网络和crf进行序列标注。


### 训练模型
>python3 train
>
### 测试
>python3 test
>
>
>也可以更改main函数中的train，test进行训练和测试。
>
### 数据配置路径
>原始数据：data/data.data
>
>模型: model_path
>
>输出数据: output/output.data
>
>日志: loss_log
>
>配置文件: config.config
>
>
### 训练数据
>
>迈	B
>
>向	E
>
>充	B
>
>满	E
>
>希	B
>
>望	E
>
>的	S
>
>新	S
>
>世	B
>
>纪	E
>
>—	B
>
>—	E
>
>一	B
>
>九	M
>
>九	M
>
>八	M
>
>年	E
>
>新	B
>
>年	E
>
>讲	B
>
>话	E
>
>（	S
>
>附	S
>
>图	B
>
>片	E
>
>１	S
>
>张	S
>
>）	S
>
>
>每句以空行分割，字与标签用\t分割.
>
### 输出结果
>
>既往青霉素、链霉素、磺胺类药物过敏史<@>既_往_青霉素_、_链_霉素_、_磺_胺类_药物_过敏史
>
>对“鸡蛋”等多种食物过敏<@>对_“_鸡蛋_”_等_多种_食物_过敏
>
>对降脂药“非诺贝特”过敏<@>对_降脂_药_“_非诺贝特_”_过敏
>
>有“青霉素”过敏史、食物过敏史<@>有_“_青霉素_”_过敏史_、_食物_过敏史
>
>对磺胺类、青霉素类及巴比妥类药物过敏<@>对_磺胺类_、_青霉_素类_及_巴比_妥类_药物_过敏
>

# test data 说明：
length = self.length 句子长度：128*x=批量*句子长度（测试时，未补全句子长度不足200的为0值）
int32 (128,)
4
4
4
4
4
5
7
5
8
6
3
8
4
3
5
4
5
5
7
5
5
10
4
4
7
7
4
4
3
3
5
6
8
5
5
6
6
5
7
9
5
5
6
4
4
5
6
5
5
5
6
6
5
4
11
8
4
4
9
8
10
7
8
16
11
13
10
12
6
10
5
6
11
8
11
9
8
6
3
8
12
9
11
5
12
12
9
7
12
8
6
12
10
6
12
12
8
7
11
6
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

max_scores=self.max_scores=128*201*16=batch*200+1*15+1
float32
max_scores_pre = int64=128*201*16

predicts = 128
list

0
list
4
[8, 8, 8, 8]
1
list
4
[8, 8, 4, 6]
2
list
4
[8, 8, 8, 8]
3
list
4
[8, 8, 8, 8]
4
list
4
[6, 2, 6, 2]
5
list
5
[8, 8, 8, 8, 2]
6
list
7
[8, 8, 8, 8, 8, 8, 8]

x_id str128 (128,200)
x_str object (128,)


 # 开始字符<PAD>
    id_char[0] = "<PAD>"
    id_label[0] = "<PAD>"
    char_id["<PAD>"] = 0
    label_id["<PAD>"] = 0

    # 新字符<NEW>
    id_char[len(chars) + 1] = "<NEW>"
    char_id["<NEW>"] = len(chars) + 1
